[View the PDF](Task 1(A).pdf)

DekNek3D Conversion Service
===========================

A small conversion backend that accepts uploaded GLB files, converts them to other 3D formats (STL, OBJ, PLY, 3MF) and exposes a download endpoint for the result.

Project layout (relevant files)
------------------------------
- `backend/` ‚Äî Node.js server and conversion helpers
  - `package.json` ‚Äî Node dependencies and scripts
  - `src/server.js` ‚Äî Express server (entry point)
  - `converters/glb_converter.js` ‚Äî JS wrapper that calls the Python converter
  - `python_scripts/glb_converter.py` ‚Äî Python script that does the actual GLB -> (stl|obj|ply|3mf) conversion using `trimesh`
  - `scripts/` ‚Äî optional Blender scripts (FBX/3MF) for advanced conversions
  - `uploads/` ‚Äî temporary upload storage
  - `output/` ‚Äî converted files are written here

Prerequisites
-------------
- Node.js (v16+)
- npm
- Python 3.8+ (required for the Python conversion script)
- pip (to install Python packages like `trimesh`) and optionally Blender for the scripts under `scripts/`

Quick start (run the backend locally) ‚úÖ
--------------------------------------
1. Change into the backend folder:

```bash
cd backend
```

2. Install Node dependencies:

```bash
npm install
```

3. (Optional but recommended) Create and activate a Python virtual environment and install `trimesh`:

Windows (PowerShell):

```powershell
python -m venv venv
venv\Scripts\Activate.ps1
pip install trimesh numpy
```

macOS / Linux:

```bash
python -m venv venv
source venv/bin/activate
pip install trimesh numpy
```

Note: `converters/glb_converter.js` calls the Python interpreter at `venv\Scripts\python.exe` by default. Update that path if you use a different location or global Python.

4. Start the server:

```bash
npm start
```

By default the server listens on http://localhost:8000 (this is currently hard-coded in `src/server.js`).

API Summary üîß
--------------
1) POST /upload
- Description: Upload a GLB file and request a conversion.
- Method: POST
- Content type: multipart/form-data
- Form fields:
  - `document` ‚Äî the uploaded GLB file (the server expects the field name `document`)
  - `format` ‚Äî desired output format: `stl`, `obj`, `ply`, or `3mf` (defaults to `stl`)
- Response (success):

```json
{
  "message": "File processed successfully",
  "downloadUrl": "http://localhost:8000/download/<filename>"
}
```

- Example curl (upload & convert to STL):

```bash
curl -X POST -F "document=@model.glb" -F "format=stl" http://localhost:8000/upload
```

2) GET /download/:filename
- Description: Download a converted file (from the `output/` folder).
- Notes: The server returns the file if it exists; it does not currently auto-delete files after download. If the file is missing, a 404 is returned.
- Example:

```bash
curl -O http://localhost:8000/download/<filename>
```

Implementation details & notes üí°
-------------------------------
- Conversions are performed by `python_scripts/glb_converter.py` which uses the `trimesh` library. That script prints the path to the generated file (the Node wrapper reads this value).
- The Node wrapper (`converters/glb_converter.js`) executes the Python script via a child process ‚Äî ensure the `pythonCmd` path points to a working Python executable.
- `python_scripts/glb_converter.py` supports `stl`, `obj`, `ply`, and `3mf`. For `obj`, a companion `.mtl` file may appear in the `output/` folder.
- There is currently no request size limit enforced by Multer in `src/server.js` ‚Äî consider adding limits for production use.
- The server port is hard-coded to `8000`. If you need to change it, edit `src/server.js` or add environment variable logic.
- The `scripts/` folder contains Blender (`bpy`) scripts for conversions that require Blender; these are optional and require running inside Blender's Python environment.

Security, cleanup & best practices ‚ö†Ô∏è
-----------------------------------
- Add `uploads/`, `output/`, and `node_modules/` to `.gitignore` to avoid committing large or temporary files.
- Implement a cleanup routine (cron job or on-start cleanup) to remove old files from `uploads/` and `output/`.
- Sanitize input filenames and consider adding authentication and rate limiting for public deployments.

Troubleshooting
---------------
- If the Python script fails with `ERROR: [message]`, run it manually to see a full traceback:

```bash
# from backend/ (with the venv activated when applicable)
python python_scripts/glb_converter.py uploads/<uploaded-file>.glb stl
```

- If you see `file not found` when downloading, verify the file exists in `backend/output/` and that the filename matches exactly.
- If the wrapper can't find Python, update `converters/glb_converter.js` `pythonCmd` to point to your Python executable.

Want help documenting a Postman collection, adding a `.gitignore`, or making port/env configuration? Reply with what you'd like next and I can add it. ‚≠ê

